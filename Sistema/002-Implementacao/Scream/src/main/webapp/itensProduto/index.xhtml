<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	template="/WEB-INF/template/template.xhtml">

	<h:head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
	</h:head>

	<ui:define name="content">

			<div
				style="margin-left: 10%; margin-right: 10%; text-align: center; width: 80%; padding: 10px;">
				<h:form id="formItensDialog">
					<p:outputLabel
						value="Itens do #{itemProductBacklogController.produto.nome}"
						style="float: none; position:relative; text-align: center;font-size: 18px; color: #0274A8" />
					<p:dataTable id="datatableItensProduto"
						value="#{itemProductBacklogController.listItensProduto}"
						var="item" widgetVar="tabelaItemProduto"
						paginatorAlwaysVisible="false" style="margin-top: 20px;" rows="10"
						emptyMessage="Nenhum item encontrado" paginator="true"
						paginatorPosition="bottom"
						paginatorTemplate="{CurrentPageReport} {FirstPageLink}{PreviousPageLink}  {PageLinks}{NextPageLink}  {LastPageLink}{RowsPerPageDropdown}"
						rowsPerPageTemplate="10,20,50,100,200" rowKey="item.id">

						<f:facet name="header">
							<p:outputPanel>
								<h:outputText value="Busca Item:" />
								<p:inputText id="globalFilter"
									onkeyup="PF('tabelaProduto').filter()"
									placeholder="Informe qualquer dado do item do produto" />


								<p:commandButton value="Novo" process="datatableItensProduto"
									update=":formItensDialog" icon="ui-icon-circle-plus"
									oncomplete="PF('novoItemDialog').show()" />
							</p:outputPanel>
						</f:facet>


						<p:column id="columnDescricao" headerText="Descrição"
							filterBy="#{item.descricao}" filterMatchMode="contains"
							filterStyle="display:none" style=" width:200px">
							<h:outputText value="#{item.descricao}" />
						</p:column>

						<p:column id="columnPeso" headerText="Peso"
							filterBy="#{item.peso}" filterMatchMode="contains"
							filterStyle="display:none">
							<h:outputText value="#{item.peso}" />
						</p:column>

						<p:column id="columnValorGanho" headerText="Valor Ganho"
							filterBy="#{item.valorGanho}" filterMatchMode="contains"
							filterStyle="display:none">
							<h:outputText value="#{item.valorGanho}" />
						</p:column>

						<p:column id="columnComplexidade" headerText="Complexidade"
							filterBy="#{item.Complexidade}" filterMatchMode="contains"
							filterStyle="display:none">
							<h:outputText value="#{item.complexidade}" />
						</p:column>

						<p:column id="columnPrioridade" headerText="Prioridade"
							filterBy="#{item.prioridade}" filterMatchMode="contains"
							filterStyle="display:none">
							<h:outputText value="#{item.prioridade}" />
						</p:column>

						<p:column id="columnAceito" headerText="Aceito P.O."
							filterBy="#{item.aceitoPO}" filterMatchMode="contains"
							filterStyle="display:none">
							<h:outputText value="#{item.aceitoPO}" />
						</p:column>


						<p:column id="columnAcao" headerText="Ações" style=" width:170px;">

							<!--ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo-->

							<p:commandButton value="Ver Teste de Aceitação"
								process="datatableItensProduto" update=":formItensDialog"
								action="#{testeAceitacaoController.manterItem()}"
								icon="ui-icon-pencil" oncomplete="PF('itemDialogHue').show()">

								<f:setPropertyActionListener value="#{item}"
									target="#{testeAceitacaoController.selectItemProductBacklog}" />

								<!--process="datatableItensProduto"-->
								<f:param name="idItem" value="#{item.id}" />
								
							</p:commandButton>

							<!--ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo-->

							<p:commandButton value="Editar" process="datatableItensProduto"
								update=":formItensDialog" icon="ui-icon-pencil"
								action="#{itemProductBacklogController.manterItem()}"
								oncomplete="PF('itemDialog').show()">



								<f:setPropertyActionListener value="#{item}"
									target="#{itemProductBacklogController.selectItemProductBacklog}" />

							</p:commandButton>



							<p:commandButton style="font-size: 13px;" value="Deletar"
								icon="ui-icon-circle-close"
								action="#{itemProductBacklogController.delete(item)}">

								<p:confirm header="Confirmação"
									message="Deseja excluir esse item do produto?"
									icon="ui-icon-alert" />

							</p:commandButton>


							<p:confirmDialog global="true" showEffect="fade"
								hideEffect="fade">

								<p:commandButton value="Sim" styleClass="ui-confirmdialog-yes"
									icon="ui-icon-check" />

								<p:commandButton value="Não" type="button"
									styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
							</p:confirmDialog>
						</p:column>
					</p:dataTable>


					<p:dialog id="itemDialog" header="Editar Item"
						widgetVar="itemDialog" resizable="false" draggable="false"
						showEffect="fade" hideEffect="fade" modal="true"
						style="font-size: 12px">
						<p:outputPanel id="painelItemDialog">
							<h:panelGrid columns="2" style="font-size: 12px">

								<h:outputLabel value="Descrição: " />

								<p:inputTextarea rows="5" cols="30"
									value="#{itemProductBacklogController.selectItemProductBacklog.descricao}"
									queryDelay="750" minQueryLength="4" />
								<h:outputLabel value="Peso: " />
								<p:inputText maxlength="30" size="30"
									value="#{itemProductBacklogController.selectItemProductBacklog.peso}" />
								<h:outputLabel value="Valor Ganho: " />
								<p:inputText maxlength="30" size="30"
									value="#{itemProductBacklogController.selectItemProductBacklog.valorGanho}" />
								<h:outputLabel value="Complexidade: " />
								<p:inputText maxlength="30" size="30"
									value="#{itemProductBacklogController.selectItemProductBacklog.complexidade}" />
								<h:outputLabel value="Prioridade: " />
								<p:inputText id="editarSelectPrioridade"
									value="#{itemProductBacklogController.selectItemProductBacklog.prioridade}" />
								<h:outputLabel value="Aceito pelo P.O. " />
								<p:selectBooleanCheckbox
									value="#{itemProductBacklogController.selectItemProductBacklog.aceitoPO}" />

							</h:panelGrid>
							<br />
							<p:commandButton value="Salvar" id="editItemProduto"
								icon="ui-icon-disk" update=":formItensDialog"
								action="#{itemProductBacklogController.update}"
								oncomplete="PF('itemDialog').hide()" />
						</p:outputPanel>
					</p:dialog>


					<p:dialog id="itemDialogHue" header="Teste de Aceitação"
						widgetVar="itemDialogHue" resizable="false" draggable="false"
						showEffect="fade" hideEffect="fade" modal="true"
						style="font-size: 12px" height="50%" width="50%">
						<h:panelGrid columns="5" style="font-size: 12px">


							<h:outputText value="Novo Teste de aceitação: " />
							<p:inputText maxlength="30" size="40"
								value="#{testeAceitacaoController.criterioAceitacao.descricao}"
								placeholder="Descrição do teste de aceitação" />

							<h:outputText value="Estado do Teste: " />
							<p:selectBooleanCheckbox
								value="#{testeAceitacaoController.criterioAceitacao.estadoTeste}"
								style="margin-left: 40%;" />
							<p:commandButton value="Criar" update=":formItensDialog"
								icon="ui-icon-circle-plus"
								action="#{testeAceitacaoController.create}"
								oncomplete="PF('itemDialogHue').show()" />

						</h:panelGrid>
						<h:panelGrid columns="1" style="font-size: 12px">

							<p:dataTable id="datatableTesteAceitacao"
								value="#{testeAceitacaoController.listAceitacao}" var="teste"
								widgetVar="tabelaItemProdutoHue" paginatorAlwaysVisible="false"
								style="margin-top: 20px;" rows="10"
								emptyMessage="Nenhum item encontrado" paginator="true"
								paginatorPosition="bottom" editable="true"
								paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks}
                             {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
								rowKey="item.id">

								<p:ajax event="rowEdit"
									listener="#{testeAceitacaoController.onRowEdit}"
									oncomplete="PF('itemDialogHue').show()" />
								<p:ajax event="rowEditCancel"
									listener="#{testeAceitacaoController.onRowCancel}"
									oncomplete="PF('itemDialogHue').show()" />



								<p:column id="testecolumnDescricao" headerText="Prioridade"
									filterBy="#{teste.descricao}" filterMatchMode="contains"
									filterStyle="display:none" width="70%">
									<p:cellEditor>

										<f:facet name="output">

											<h:outputText value="#{teste.descricao}" />

										</f:facet>

										<f:facet name="input">

											<p:inputText id="testeId" value="#{teste.descricao}"
												label="Descricao" />

										</f:facet>
									</p:cellEditor>
								</p:column>

								<p:column id="testechecklist" filterBy="#{teste.estadoTeste}"
									headerText="Estado do teste" filterMatchMode="contains"
									filterStyle="display:none">
									<p:cellEditor>

										<f:facet name="output">

											<h:outputText value="#{teste.estadoTeste}"
												style="margin-left: 30%;" />
										</f:facet>

										<f:facet name="input">

											<p:selectBooleanCheckbox disabled="false"
												value="#{teste.estadoTeste}" style="margin-left:40%;" />

										</f:facet>
									</p:cellEditor>
								</p:column>

								<p:column style="width:10%; white-space: nowrap;">
									<p:rowEditor
										style="display: inline-block; vertical-align: middle;" />

									<p:commandButton update=":formItensDialog" icon="ui-icon-trash"
										action="#{testeAceitacaoController.remove(teste)}"
										oncomplete="PF('itemDialogHue').show()"
										style="font-size: 5px; vertical-align: middle; margin-left: 3px" />
								</p:column>
							</p:dataTable>
						</h:panelGrid>
					</p:dialog>



					<p:dialog id="novoItemDialog" header="Criar Novo Item"
						widgetVar="novoItemDialog" resizable="false" draggable="false"
						showEffect="fade" hideEffect="fade" modal="true"
						style="font-size: 12px">
						<p:outputPanel id="painelNovoItemDialog">
							<h:panelGrid columns="2" style="font-size: 12px">

								<h:outputLabel value="Descrição: " />

								<p:inputTextarea rows="5" cols="30"
									value="#{itemProductBacklogController.itemProductBacklog.descricao}"
									queryDelay="750" minQueryLength="4" />
								<h:outputLabel value="Peso: " />
								<p:inputText maxlength="30" size="30"
									value="#{itemProductBacklogController.itemProductBacklog.peso}" />
								<h:outputLabel value="Valor Ganho: " />
								<p:inputText maxlength="30" size="30"
									value="#{itemProductBacklogController.itemProductBacklog.valorGanho}" />
								<h:outputLabel value="Complexidade: " />
								<p:inputText maxlength="30" size="30"
									value="#{itemProductBacklogController.itemProductBacklog.complexidade}" />
								<h:outputLabel value="Prioridade: " />
								<p:inputText id="editarNovoSelectPrioridade"
									value="#{itemProductBacklogController.itemProductBacklog.prioridade}" />
								<h:outputLabel value="Aceito pelo P.O. " />
								<p:selectBooleanCheckbox
									value="#{itemProductBacklogController.itemProductBacklog.aceitoPO}" />

							</h:panelGrid>

							<br />
							<p:commandButton value="Salvar" id="novoItemProduto"
								icon="ui-icon-disk" update=":formItensDialog"
								action="#{itemProductBacklogController.create}"
								oncomplete="PF('novoItemDialog').hide()" />
						</p:outputPanel>
					</p:dialog>
				</h:form>
			</div>
	</ui:define>

</ui:composition>